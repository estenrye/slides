all:
  children:
    external_load_balancer:
      hosts:
        haproxy01:
          ansible_host: haproxy01.rancher.ryezone.com
        haproxy02:
          ansible_host: haproxy02.rancher.ryezone.com
    kubernetes_cluster:
      children:
        controlplane:
          children:
            initial_controlplane:
              hosts:
                controlplane01:
                  ansible_host: controlplane01.rancher.ryezone.com
                  firewall_allow_inbound_services_exposed_to_friends:
                    - service: SSH
                      port: 22
                      protocol: tcp
                    - service: HTTP
                      protocol: tcp
                      port: 80
                    - service: HTTPS
                      protocol: tcp
                      port: 443  
                    - service: etcd client api
                      protocol: tcp
                      port: 2379
                    - service: etcd peer api
                      protocol: tcp
                      port: 2380
                    - service: Kubernetes API Server
                      protocol: tcp
                      port: 6443
                    - service: RKE2 Node Join
                      protocol: tcp
                      port: 9345
                    - service: Kubernetes Kubelet API
                      protocol: tcp
                      port: 10250
                    - service: Kubernetes Kube Scheduler
                      protocol: tcp
                      port: 10251
                    - service: Kubernetes Kube Controller Manager
                      protocol: tcp
                      port: 10252
            additional_controlplane:
              hosts:
                controlplane02:
                  ansible_host: controlplane02.rancher.ryezone.com
                  firewall_allow_inbound_services_exposed_to_friends:
                    - service: SSH
                      port: 22
                      protocol: tcp
                    - service: HTTP
                      protocol: tcp
                      port: 80
                    - service: HTTPS
                      protocol: tcp
                      port: 443  
                    - service: etcd client api
                      protocol: tcp
                      port: 2379
                    - service: etcd peer api
                      protocol: tcp
                      port: 2380
                    - service: Kubernetes API Server
                      protocol: tcp
                      port: 6443
                    - service: RKE2 Node Join
                      protocol: tcp
                      port: 9345
                    - service: Kubernetes Kubelet API
                      protocol: tcp
                      port: 10250
                    - service: Kubernetes Kube Scheduler
                      protocol: tcp
                      port: 10251
                    - service: Kubernetes Kube Controller Manager
                      protocol: tcp
                      port: 10252
                controlplane03:
                  ansible_host: controlplane03.rancher.ryezone.com
                  firewall_allow_inbound_services_exposed_to_friends:
                    - service: SSH
                      port: 22
                      protocol: tcp
                    - service: HTTP
                      protocol: tcp
                      port: 80
                    - service: HTTPS
                      protocol: tcp
                      port: 443  
                    - service: etcd client api
                      protocol: tcp
                      port: 2379
                    - service: etcd peer api
                      protocol: tcp
                      port: 2380
                    - service: Kubernetes API Server
                      protocol: tcp
                      port: 6443
                    - service: RKE2 Node Join
                      protocol: tcp
                      port: 9345
                    - service: Kubernetes Kubelet API
                      protocol: tcp
                      port: 10250
                    - service: Kubernetes Kube Scheduler
                      protocol: tcp
                      port: 10251
                    - service: Kubernetes Kube Controller Manager
                      protocol: tcp
                      port: 10252
  vars:
    ansible_user: automation-user
    platform_environment: rancher
    install_rancher: true
    taint_server_nodes: false
    kubernetes_api_server_vip: 10.5.99.17
    virtual_router_id: 51
    virtual_router_auth_pass: 79
    dns_entries:
      - record: haproxy01
        value: 10.5.99.15
      - record: haproxy02
        value: 10.5.99.16
      - record: kube-api
        value: 10.5.99.17
      - record: "*"
        value: 10.5.99.17
      - record: controlplane01
        value: 10.5.99.24
      - record: controlplane02
        value: 10.5.99.25
      - record: controlplane03
        value: 10.5.99.26
    rke2_ingress_servers:
      - name: controlplane01
        address: controlplane01.{{ kubernetes_zone }}
      - name: controlplane02
        address: controlplane02.{{ kubernetes_zone }}
      - name: controlplane03
        address: controlplane03.{{ kubernetes_zone }}
